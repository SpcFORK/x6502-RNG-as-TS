{"version":3,"sources":["../src/eobj.ts","../src/rng.ts"],"sourcesContent":["function eobj<C extends Record<any, any> & unknown>(obj: C, names: string[] = []) {\n  if (!obj) throw new Error(`No object provided to eobj.`);\n\n  if (obj?.name) names.push(obj.name);\n\n  names.push('default');\n\n  let eo: Record<any, C> = {}\n  for (const name of names) {\n    eo[name] = obj;\n    try { (window as any)[name] = obj } catch { }\n  }\n\n  // I hate TS and builders having the need to warn\n  // 'OOPS! YOU CANT USE BOTH EXPORT PARADIGMS, WAHHH!'\n  try { (globalThis.eval)('module').exports = eo } catch { }\n\n  return eo\n}\n\n// Bootstarp !\nexport default eobj(eobj, ['eobj']).default;","/* x65-02 ASM - B8 RNG 255\n.ZEROPAGE\nSEED: .RES 2\n\n.CODE\nPRNG:\n    LDY #8      ; Iter count\n    LDA SEED+0\nLOOP_START:\n    ASL         ; Shift\n    ROL SEED+1\n    BCC SKIP_MASK\n    EOR #$39    ; Mask\nSKIP_MASK:\n    DEY\n    BNE LOOP_START\n    STA SEED+0\n    CMP #0      ; Reload Flags\n    RTS\n*/\n\nimport eobj from './eobj';\n\nfunction* B8RNG255(seed: number, core: (core?: any) => {}): Generator<number, { error: unknown, type: string, LAST_VAL: unknown }, number> {\n  if (seed === undefined || seed === 0)\n    throw new Error(\"Seed cannot be 0 or Falsey!\");\n  if (seed > 255 || seed < 0)\n    throw new Error(\"Seed must be between 0 and 255!\");\n\n  function rol(value: number, carry: boolean): { result: number; carry: boolean; } {\n    value &= 0xFF;\n    const msb = (value >> 7) & 1;\n    let result = (value << 1) & 0xFF;\n    if (carry) result |= 1;\n    carry = !!msb;\n    return { result, carry };\n  }\n\n  let y: number, a: number, carryG: boolean, SEED: number;\n  function init(): number {\n    SEED ||= (seed & 0xFF);\n    y = 8;\n    a = SEED & 0xFF;\n    carryG = false;\n    return loopStart();\n  }\n\n  function loopStart(): number {\n    a <<= 1;\n\n    let { result, carry } = rol((a >> 1) & 0xFF, carryG);\n    [a, carryG] = [result, carry];\n\n    if (carryG) a ^= 0x39;\n    return loopEnd();\n  }\n\n  function loopEnd(): number {\n    y--;\n    if (y !== 0) return loopStart();\n    SEED = (SEED & ~0xFF) | (a & 0xFF);\n    return SEED;\n  }\n\n  let LAST_VAL: number | undefined = void 0;\n  let CROSSCONTAM: unknown;\n  let state = new class {\n    on = true\n    lastVal = () => LAST_VAL\n    cross = () => CROSSCONTAM\n  }\n\n  while (state.on) try {\n    LAST_VAL = init();\n    CROSSCONTAM = yield LAST_VAL;\n    core?.(state);\n\n    if (typeof CROSSCONTAM == 'boolean') state.on = false;\n    else if (typeof CROSSCONTAM == 'number') SEED = CROSSCONTAM;\n  } catch (e) {\n    return { error: e, type: 'error', LAST_VAL }\n  }\n\n  return { error: void 0, type: 'success', LAST_VAL }\n}\n\nexport default eobj(B8RNG255, ['B8RNG255']).default"],"mappings":"mBAAA,SAASA,EAA2CC,EAAQC,EAAkB,CAAC,EAAG,CAChF,GAAI,CAACD,EAAK,MAAM,IAAI,MAAM,6BAA6B,EAEnDA,GAAK,MAAMC,EAAM,KAAKD,EAAI,IAAI,EAElCC,EAAM,KAAK,SAAS,EAEpB,IAAIC,EAAqB,CAAC,EAC1B,QAAWC,KAAQF,EAAO,CACxBC,EAAGC,CAAI,EAAIH,EACX,GAAI,CAAG,OAAeG,CAAI,EAAIH,CAAI,MAAQ,CAAE,CAC9C,CAIA,GAAI,CAAG,WAAW,KAAM,QAAQ,EAAE,QAAUE,CAAG,MAAQ,CAAE,CAEzD,OAAOA,CACT,CAGA,IAAOE,EAAQL,EAAKA,EAAM,CAAC,MAAM,CAAC,EAAE,QCEpC,SAAUM,EAASC,EAAcC,EAA0G,CACzI,GAAID,IAAS,QAAaA,IAAS,EACjC,MAAM,IAAI,MAAM,6BAA6B,EAC/C,GAAIA,EAAO,KAAOA,EAAO,EACvB,MAAM,IAAI,MAAM,iCAAiC,EAEnD,SAASE,EAAIC,EAAeC,EAAqD,CAC/ED,GAAS,IACT,IAAME,EAAOF,GAAS,EAAK,EACvBG,EAAUH,GAAS,EAAK,IAC5B,OAAIC,IAAOE,GAAU,GACrBF,EAAQ,CAAC,CAACC,EACH,CAAE,OAAAC,EAAQ,MAAAF,CAAM,CACzB,CAEA,IAAIG,EAAWC,EAAWC,EAAiBC,EAC3C,SAASC,GAAe,CACtB,OAAAD,IAAUV,EAAO,IACjBO,EAAI,EACJC,EAAIE,EAAO,IACXD,EAAS,GACFG,EAAU,CACnB,CAEA,SAASA,GAAoB,CAC3BJ,IAAM,EAEN,GAAI,CAAE,OAAAF,EAAQ,MAAAF,CAAM,EAAIF,EAAKM,GAAK,EAAK,IAAMC,CAAM,EACnD,OAACD,EAAGC,CAAM,EAAI,CAACH,EAAQF,CAAK,EAExBK,IAAQD,GAAK,IACVK,EAAQ,CACjB,CAEA,SAASA,GAAkB,CAEzB,OADAN,IACIA,IAAM,EAAUK,EAAU,GAC9BF,EAAQA,EAAO,KAAUF,EAAI,IACtBE,EACT,CAEA,IAAII,EACAC,EACAC,EAAQ,IAAI,KAAM,CACpB,GAAK,GACL,QAAU,IAAMF,EAChB,MAAQ,IAAMC,CAChB,EAEA,KAAOC,EAAM,IAAI,GAAI,CACnBF,EAAWH,EAAK,EAChBI,EAAc,MAAMD,EACpBb,IAAOe,CAAK,EAER,OAAOD,GAAe,UAAWC,EAAM,GAAK,GACvC,OAAOD,GAAe,WAAUL,EAAOK,EAClD,OAASE,EAAG,CACV,MAAO,CAAE,MAAOA,EAAG,KAAM,QAAS,SAAAH,CAAS,CAC7C,CAEA,MAAO,CAAE,MAAO,OAAQ,KAAM,UAAW,SAAAA,CAAS,CACpD,CAEA,IAAOI,EAAQC,EAAKpB,EAAU,CAAC,UAAU,CAAC,EAAE","names":["eobj","obj","names","eo","name","eobj_default","B8RNG255","seed","core","rol","value","carry","msb","result","y","a","carryG","SEED","init","loopStart","loopEnd","LAST_VAL","CROSSCONTAM","state","e","rng_default","eobj_default"]}